<div class="panel panel-default">
  <div class="panel-body">
    <div class="header">
      <ul class="nav nav-pills pull-right">
        <li><a ng-href="#/settings">Settings</a></li>
      </ul>
      <h3 class="text-muted">Bricks</h3>
    </div>
  </div>
</div>
<div class="alert alert-danger" ng-show="error!=undefined">
  <button type="button" class="close" ng-click="error=undefined"><span>&times;</span>
  </button>
  {{error}}
</div>
<div class="container">
  <div class="row" ng-if="state == SETTINGS_STATE.Loading">
    <p>Loading</p>
  </div>
  <div class="row" ng-if="state == SETTINGS_STATE.NoBricksAvailable">
    <div class="jumbotron text-center">
      <div class="container">
        <h1>Welcome</h1>
        <p>Here the brick of your content will be shown</p>
        <p>Head over to settings to create the bricks you want</p>
        <p><a ng-href="#/settings" class="btn btn-primary" role="button">Go To Settings &raquo;</a></p>
      </div>
    </div>
  </div>
  <div class="row" ng-if="state == SETTINGS_STATE.Completed">
    <div ng-repeat="brick in bricks">
      <div class="col-md-4">
        <div class="panel panel-default">
          <div class="panel-heading">
            <div class="btn-group btn-group-sm pull-right">
              <button type="button" class="btn btn-default" ng-click="reloadContent(brick)">
                <span class="glyphicon glyphicon-refresh"></span>
              </button>
            </div>
            <h4>{{brick.data.name}}</h4>
            <h4><small>{{brick.data.path}}</small></h4>
          </div>
          <p class="text-center" ng-if="brick.state == BRICK_STATE.Created">Not Loaded</p>
          <p class="text-center" ng-if="brick.state == BRICK_STATE.Loading">Loading content, please wait</p>
          <div ng-if="brick.state == BRICK_STATE.Completed">
            <!-- Text Brick-->
            <textarea ng-if="brick.data.type == BRICK_TYPE.Text" class="myTextArea" rows="20">{{brick.content}}</textarea>
            <!-- Table Brick-->
            <div ng-if="brick.data.type == BRICK_TYPE.Table" class="table-responsive">
              <table class="table table-condensed table-hover">
                <thead>
                  <tr>
                    <td ng-repeat="key in keys(brick.content[0]) | filter:'!$$'"> {{key}} </td>
                  </tr>
                </thead>
                <tbody>
                  <tr ng-repeat-start="item in brick.content | filter:searchRows" ng-init="item.$$expanded=false" ng-click="item.$$expanded=!item.$$expanded" ng-class="{ 'active' : item.$$expanded == true }">
                    <td ng-repeat="key in keys(item) | filter:'!$$'"> {{ item[key] | limitTo : 50 }} </td>
                  </tr>
                  <tr ng-repeat-end="" ng-if="item.$$expanded">
                    <!-- Need to remove the $$ parameters from the length ? -->
                    <td colspan="{{keys(brick.content[0]).length}}">
                      <dl class="dl-horizontal">
                        <div ng-repeat="key in keys(item) | filter:'!$$'">
                          <dt>{{key}}</dt>
                          <dd>{{item[key]}}</dd>
                        </div>
                      </dl>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <!-- Image brick -->
            <img ng-if="brick.data.type == BRICK_TYPE.Image" ng-src="{{imagePathOfBrick(brick)}}" width="100%" height="100%">
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
